(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4460fca2"],{"2f21":function(e,t,n){"use strict";var s=n("79e5");e.exports=function(e,t){return!!e&&s(function(){t?e.call(null,function(){},1):e.call(null)})}},"39ec":function(e,t,n){"use strict";t["a"]=function(e){return e<10?"0"+e:e}},5492:function(e,t,n){"use strict";var s=n("8e72"),a=n.n(s);a.a},"55dd":function(e,t,n){"use strict";var s=n("5ca1"),a=n("d8e8"),i=n("4bf8"),r=n("79e5"),c=[].sort,o=[1,2,3];s(s.P+s.F*(r(function(){o.sort(void 0)})||!r(function(){o.sort(null)})||!n("2f21")(c)),"Array",{sort:function(e){return void 0===e?c.call(i(this)):c.call(i(this),a(e))}})},"8e72":function(e,t,n){},a061:function(e,t,n){"use strict";t["a"]=function(e,t){var n=e.getDay()-1;return-1===n&&(n=t.length-1),{index:n,day:t[n]}}},a439:function(e,t,n){},cbb2:function(e,t,n){"use strict";var s=n("a439"),a=n.n(s);a.a},cd3a:function(e,t,n){"use strict";n("55dd");t["a"]=function(e,t,n){return t.sort(function(t,s){if(n){if("ascending"==e)return t[n]-s[n];if("descending"==e)return s[n]-t[n]}}),t}},d28b:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{staticClass:"add-item",on:{click:e.addNewEvent}},[e._v("Neuen Termin hinzufÃ¼gen")]),n("h2",[e._v("Termine")]),n("router-view"),0==e.days.length?n("div",{staticClass:"no-items-added"},[n("p",[e._v("Keine Termine eingetragen.")])]):e._e(),e.days.length>0?n("div",{staticClass:"cal"},e._l(e.days,function(t,s){return n("div",{key:s,staticClass:"day block"},[n("div",{staticClass:"day-info"},[n("h3",[e._v(e._s(e.getWeekDay(t[0])))]),n("h4",[e._v(e._s(e.getDate(t[0])))])]),e._l(t,function(t,s){return n("div",{key:s,staticClass:"event"},[n("ul",[n("li",{staticClass:"time"},[e._v(e._s(e.getEventTime(t)))]),e.shopUserName(t)?n("li",[n("span",{staticClass:"title"},[e._v("Kunde:")]),e._v(" "+e._s(e.shopUserName(t))+"\n          ")]):e._e(),n("li",[n("span",{staticClass:"title"},[e._v("Service:")]),e._v(" "+e._s(t.service))]),e.shopUserTel(t)?n("li",[n("span",{staticClass:"title"},[e._v("Tel:")]),e._v(" "+e._s(e.shopUserTel(t))+"\n          ")]):e._e(),n("li",[n("span",{staticClass:"title"},[e._v("Mitarbeiter:")]),e._v(" "+e._s(t.employee))])]),n("button",{staticClass:"icon remove",on:{click:function(n){e.deleteEvent(t)}}},[n("span",[e._v("remove")])])])})],2)})):e._e()],1)},a=[],i=(n("ac6a"),n("d476")),r=n("a061"),c=n("cd3a"),o=function(e){var t,n=[],s=[];return e.forEach(function(a,i){0===i?s.push(a):t!==a.dayTimeStamp?(n.push(s),s=[a]):s.push(a),i===e.length-1&&n.push(s),t=a.dayTimeStamp}),n},u=n("39ec"),d={computed:{days:function(){var e=this.$store.getters.shopEvents;return e}},methods:{addNewEvent:function(){this.$router.push("/admin/events/new-event")},deleteEvent:function(e){var t=this.$firebase.database().ref("events/"+e.key);t.remove()},shopUserTel:function(e){var t=this.$store.getters.shopUsers[e.uid];return e.customerTel?e.customerTel:!!t&&t.customerTel},shopUserName:function(e){var t=this.$store.getters.shopUsers[e.uid];return e.customerName?e.customerName:!!t&&t.username},getEventTime:function(e){var t=Object(u["a"])(new Date(e.timestamp).getHours()),n=Object(u["a"])(new Date(e.timestamp).getMinutes());return"".concat(t,":").concat(n)},getWeekDay:function(e){var t=new Date(e.dayTimeStamp),n=Object(r["a"])(t,i["a"]);return"".concat(n.day.shortname)},getDate:function(e){var t=new Date(e.dayTimeStamp);return"".concat(t.getDate(),".").concat(t.getMonth()+1)},getUsers:function(e){var t=this,n=this,s={},a=e.map(function(e){return t.$firebase.database().ref("users").child(e).once("value")});Promise.all(a).then(function(e){e.forEach(function(e){s[e.key]=e.val()}),n.$store.dispatch("updateShopUsers",s)}).catch(function(e){console.log(e)})},getEvents:function(e,t){var n=this,s=[];this.$store.dispatch("updateIsLoading",!0);var a=this.$firebase.database().ref("events").orderByChild("dayTimeStamp").startAt(e).endAt(t);try{a.on("value",function(e){var t=[];if(e.val()){var a=e.val();for(var i in a){var r=a[i];r.key=i,t.push(r),-1==s.indexOf(r.uid)&&s.push(r.uid)}t=Object(c["a"])("ascending",t,"timestamp"),t=Object(c["a"])("ascending",t,"dayTimeStamp"),t=o(t),n.getUsers(s)}else console.log("Keine Termine gespeichert");n.$store.dispatch("updateShopEvents",t),n.$store.dispatch("updateIsLoading",!1)})}catch(e){console.log("Konnte keine events abrufen"),this.$store.dispatch("updateIsLoading",!1)}}},mounted:function(){var e=new Date;e.setHours(0,0,0,0),e=e.getTime();var t=e+864e5*this.$variables.admin.events.daysToShow;this.getEvents(e,t)}},l=d,v=(n("cbb2"),n("5492"),n("2877")),f=Object(v["a"])(l,s,a,!1,null,"4c913a2e",null);f.options.__file="Events.vue";t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-4460fca2.ef703cfd.js.map